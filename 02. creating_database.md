# **Part I**:

# 1 - Creating database:
``` sql
CREATE database project_drug_resistant_bacteria

```
# **Part II**: 
#  2 - Creating table schemas to receive files 
###  (Check pre-processing for data dimensionality)

### 2.1 - Creating table for "a" files 
``` sql
--(Sales notifications of all compounded drugs)

CREATE TABLE industrialized_med (
    ANO_VENDA INT,
    MES_VENDA INT,
    UF_VENDA CHAR(2),
    MUNICIPIO_VENDA VARCHAR(32),
    PRINCIPIO_ATIVO VARCHAR(602),
    DESCRICAO_APRESENTACAO VARCHAR(144),
    QTD_VENDIDA INT,
    UNIDADE_MEDIDA CHAR(6),
    CONSELHO_PRESCRITOR CHAR(4),
    UF_CONSELHO_PRESCRITOR CHAR(2),
    TIPO_RECEITUARIO CHAR(3),
    CID10 CHAR(4),
    SEXO CHAR(1),
    IDADE INT,
    UNIDADE_IDADE CHAR(3)
);
```



### 2.2 - Creating table for "b" files 
``` sql
-- (Sales notifications of all industrialized drugs)

CREATE TABLE manipulated_med (
    ANO_VENDA INT,
    MES_VENDA INT,
    UF_VENDA CHAR(2),
    MUNICIPIO_VENDA VARCHAR(27),
    PRINCIPIO_ATIVO VARCHAR(45),
    QTD_ATIVO_POR_UNID_FARMACOTEC INT,
    UNIDADE_MEDIDA_PRINCIPIO_ATIVO CHAR(9),
    QTD_UNIDADE_FARMACOTECNICA INT,
    TIPO_UNIDADE_FARMACOTECNICA CHAR(10),
    CID10 CHAR(4),
    SEXO CHAR(1),
    IDADE INT,
    UNIDADE_IDADE CHAR(3)
);

```

### 2.3 - Creating table for "c" files

``` sql
-- (Notifications of all obituaries in Brazil)

CREATE TABLE death_obituaries (
    CONTADOR INT,
    ORIGEM CHAR(1),
    TIPOBITO CHAR(1),
    DTOBITO CHAR(8),
    HORAOBITO CHAR(7),
    NATURAL CHAR(5),
    CODMUNNATU CHAR(8),
    DTNASC CHAR(10),
    IDADE CHAR(3),
    SEXO CHAR(1),
    RACACOR CHAR(3),
    ESTCIV CHAR(3),
    ESC CHAR(3),
    ESC2010 CHAR(3),
    SERIESCFAL CHAR(3),
    OCUP CHAR(8),
    CODMUNRES CHAR(6),
    LOCOCOR CHAR(3),
    CODESTAB CHAR(9),
    ESTABDESCR VARCHAR(40),
    CODMUNOCOR CHAR(6),
    IDADEMAE CHAR(4),
    ESCMAE CHAR(3),
    ESCMAE2010 CHAR(3),
    SERIESCMAE CHAR(3),
    OCUPMAE CHAR(8),
    QTDFILVIVO CHAR(4),
    QTDFILMORT CHAR(4),
    GRAVIDEZ CHAR(3),
    SEMAGESTAC CHAR(4),
    GESTACAO CHAR(3),
    PARTO CHAR(3),
    OBITOPARTO CHAR(3),
    PESO CHAR(6),
    TPMORTEOCO CHAR(3),
    OBITOGRAV CHAR(3),
    OBITOPUERP CHAR(3),
    ASSISTMED CHAR(3),
    EXAME CHAR(3),
    CIRURGIA CHAR(3),
    NECROPSIA CHAR(3),
    LINHAA CHAR(20),
    LINHAB CHAR(20),
    LINHAC CHAR(20),
    LINHAD CHAR(20),
    LINHAII CHAR(30),
    CAUSABAS CHAR(4),
    CB_PRE CHAR(4),
    COMUNSVOIM CHAR(8),
    DTATESTADO CHAR(10),
    CIRCOBITO CHAR(3),
    ACIDTRAB CHAR(3),
    FONTE CHAR(3),
    NUMEROLOTE CHAR(10),
    TPPOS CHAR(3),
    DTINVESTIG CHAR(10),
    CAUSABAS_O CHAR(4),
    DTCADASTRO CHAR(10),
    ATESTANTE CHAR(3),
    STCODIFICA CHAR(3),
    CODIFICADO CHAR(3),
    VERSAOSIST CHAR(6),
    VERSAOSCB CHAR(4),
    FONTEINV CHAR(3),
    DTRECEBIM CHAR(10),
    ATESTADO VARCHAR(50),
    DTRECORIGA CHAR(10),
    CAUSAMAT CHAR(4),
    ESCMAEAGR1 CHAR(4),
    ESCFALAGR1 CHAR(4),
    STDOEPIDEM CHAR(3),
    STDONOVA CHAR(3),
    DIFDATA CHAR(5),
    NUDIASOBCO CHAR(6),
    NUDIASOBIN CHAR(5),
    DTCADINV CHAR(10),
    TPOBITOCOR CHAR(3),
    DTCONINV CHAR(10),
    FONTES CHAR(6),
    TPRESGINFO CHAR(3),
    TPNIVELINV CHAR(3),
    NUDIASINF CHAR(5),
    DTCADINF CHAR(10),
    MORTEPARTO CHAR(3),
    DTCONCASO CHAR(10),
    FONTESINF CHAR(7),
    ALTCAUSA CHAR(3)
);
```

### 2.4 - Creating table for "d" type file

``` sql
-- (Municipal Geospatial and demographic data)

CREATE TABLE city_ar_pop(
    ID CHAR(4),
    CD_UF CHAR(2),
    NM_UF VARCHAR(19),
    NM_UF_SIGLA CHAR(2),
    CD_MUN CHAR(7),
    NM_MUN VARCHAR(32),
    AR_MUN_2022 CHAR(10),
    "POPULAÇÃO ESTIMADA" CHAR(11)
);

```






 # **Part III**:
 
 ## 3.1 - Using the Bulk copy program utility (BCP) to insert data into their respective tables inside Microsoft SQL server.
 
 
### 3.2 - How to Install BCP:

If you installed SQL Server through the default [Microsoft link](https://www.microsoft.com/en-us/sql-server/sql-server-downloads), BCP utility has also been installed.


### 3.3 - What is BCP?

The Bulk Copy Program (BCP) is a command-line utility provided by Microsoft for bulk copying data between an instance of SQL Server and data files in a user-specified format. It is a powerful tool that allows you to efficiently import and export large amounts of data to and from SQL Server databases.

The provided Batch commands work in **any terminal**, including the Windows command prompt (cmd.exe). The Windows command prompt is an environment where you can execute Batch scripts, commands, and interact with the operating system. Therefore, these commands should function in cmd.exe and most terminals that are compatible with Windows commands. 

(However, the syntax and specific commands may vary between different operating systems and terminals. So, if you are running these commands in an environment other than Windows, such as a terminal emulator on Linux or macOS, you may need to make adjustments for them to work correctly).

If you need more information on BCP, here's the **official documentation**: [BCP Utility Documentation](https://learn.microsoft.com/en-us/sql/tools/bcp-utility?view=sql-server-ver16).



### 3.4 - To create a .bat file you can copy the structure below in a .txt file and save as a .bat extension.  


 ### 3.4.1 - Example of a BCP command for bulk file insertion below:
 
 ``` batch

REM Without @echo off, each command within the .bat file would be displayed in the command prompt as it is executed, which can make the script's output more cluttered and harder to follow.

@echo off

REM - Function to import data from CSV files to SQL Server using BCP

:ImportData
set "server=DESKTOP-XXXXXXX"                   
set "database=project_drug_resistant_bacteria" 
set "schema=dbo"                               
set "table=death_obituaries"                   
set "folder_path=C: (...) projects\My_2ndEDA_Drug_Resistent_Bacteria\project_data\raw_sim_files"

for %%F in ("%folder_path%\*.csv") do (
    bcp "%database%.%schema%.%table%" in "%%~fF" -S %server% -T -c -t";" -r "\n" -C 1252
)

REM Display a message indicating the completion of the data import process
echo Data import completed.
exit /b

```
### Now we save this as a .bat file. 



### 3.4.2 - Other file paths:
So we need to create a batch file for each insertion job, after creating a new script, we need to modify the .bat file contents, changing the folder_path and, and the target table inside the file

### 3.5 - Now we just need to run the files: 




![image](https://github.com/datajoedata/My2ndEDA/assets/116616136/202cf9ce-c9c7-4aed-9f63-4662bf94ea49)


